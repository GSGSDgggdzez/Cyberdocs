# Finding the Right Module

- It's searching for a DLL or something similar inside a program that has no memory protection which means no DEP, no ASLR depth.

- For this we will use a module called "mona.py" which allows us to see process protection
https://github.com/corelan/mona

- Start immunity debugger without launching it, on the search bar type `!mona modules` to list the modules. 

- What interests us is the one with `False` protection and attached to the vulnerable server.

- To really find the opcode (which is a 'jump')
`msf-nasm_shell> JMP ESP` which is a jump command that we will use as a pointer that will jump to our shellcode. 

- We can use the result of 'msf-nasm_shell' and go in immunity type: `!mona find -s "\xff\xe4" -m essfunc.dll` the dll file that has the module with no protection enabled.

- What is interesting here is the address returned [Results] that we can test and see which one works
With this address we can modify our script and replace the `"B"*4` part with the reverse character found in debugger: (<---)

In debugger:
- Search for the return address found in [Results]
- `F2` to set a breakpoint

Run the script

- In the EIP we get exactly the same return address found in [Results] which means we control the EIP and we can generate our shell code.